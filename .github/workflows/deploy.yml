name: Deploy HTML Site üé®

on:
  push:
    branches: ["master"]

jobs:
  deploy:
    runs-on: self-hosted

    steps:
      - name: Checkout Code üõéÔ∏è
        uses: actions/checkout@v3

      - name: Deploy with Docker üê≥
        run: |
          echo "üöÄ –ù–∞—á–∏–Ω–∞—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ..."
          
          # 1. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å), —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –∏–º–µ–Ω
          # "|| true" –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —Å–∫—Ä–∏–ø—Ç –Ω–µ –ø–∞–¥–∞–ª, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –µ—â–µ –Ω–µ—Ç
          docker rm -f my-html-site || true

          # 2. –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Nginx
          # -d : –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
          # -p 8080:80 : —Å–∞–π—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8080
          # -v $(pwd):/usr/share/nginx/html : –ü—Ä—è–º–∞—è —Å–≤—è–∑—å —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º
          # --name my-html-site : –∏–º—è, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏
          
          docker run -d \
            --name my-html-site \
            --restart always \
            -p 8080:80 \
            -v $(pwd):/usr/share/nginx/html \
            nginx:alpine

          echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://192.168.145.133:8080"